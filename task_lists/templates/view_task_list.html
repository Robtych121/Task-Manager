{% extends "base.html" %}
{% load bootstrap_tags %}

{% block page_title %}{{ task_list.name }}{% endblock %}
{% block page_heading%}<span>{{ task_list.name }}</span><span id="list_options_con"></span>{% endblock %}

{% block content %}
<div class="task-list-container">
{% for task in tasks %}
<div class="card">
<div class="card-body task_list">
<table class="col-12">
    <tr>
        <td style="width: 20px;">
            <form action="">
                <label class="container">
                    <input class="form-check-input position-static" type="checkbox" name="completed" id="completed" {% if task.completed == 'Yes' %}checked {% endif %}>
                    <span class="checkmark"></span>
                </label>
            </form>
        </td>
        <td>
            <div>
                {{ task.name}}
            </div>
        </td>
        <td style="width: 60px;">
            <div class="task_extras">
                {% if task.assigned_to == user.id %}
                    {{user.username}}
                {% endif%}
            </div>
        </td>
        <td style="width: 20px;">
            <form action="" method="POST">
                <label class="container">
                    <input class="form-check-input position-static" type="checkbox" name="importance" id="importance" {% if task.importance == 'Yes' %}checked {% endif %}>
                    <span class="checkmark1"></span>
                </label>
            </form>
        </td>
    </tr>
</table>            
</div>
</div>
{% empty %}
No Tasks Created
{% endfor %}
</div>
<hr>
<div class="enter-task-container">
    <form action="{% url 'create_new_task_post' %}" method="POST">
        {% csrf_token %}
        <div class="input-group mb-3">
            <input type="hidden" name="new_task_list_id" id="id_new_task_list_id" value="{{ task_list.id }}">
            <input type="hidden" name="new_task_list_user" id="id_new_task_list_user" value="{{ user.id }}">
            <input type="text" class="form-control" id="id_new_task" name="new_task" placeholder="Start typing.." aria-label="Recipient's username" aria-describedby="button-addon2" required>
            <div class="input-group-append">
              <button class="btn btn-outline-success" type="submit" id="button-addon2">Add Task</button>
            </div>
          </div>
    </form>
</div>
<div id="task_list_options_container">
    <div class="dropdown">
        <a class="btn btn-secondary btn-sm dropdown-toggle btn-settings" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <i class="fas fa-cogs"></i>
        </a>
      
        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuLink">
            {% if user.is_authenticated %}
                <a class="dropdown-item" href="">Edit</a>
                <a class="dropdown-item" href="">Sort By</a>
                <a class="dropdown-item" href="" data-toggle="modal" data-target="#DeleteListModal">Delete</a>
            {% endif %}
        </div>
</div>
</div>

<div class="modal fade" id="DeleteListModal" tabindex="-1" role="dialog" aria-labelledby="DeleteListModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="DeleteListModalLabel">Are you sure?</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p>This action cannot be reversed once completed.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
          <button type="button" href="" class="btn btn-success">Save changes</button>
        </div>
      </div>
    </div>
  </div>
<script>
    if($('#task_list_options_container')) {
        list_options_con.appendChild(task_list_options_container);
    }
</script>
{% endblock %}